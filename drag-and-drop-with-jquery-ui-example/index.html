
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>
      
        Drag and drop with jQuery UI example - 
      
      Solid Recipes
    </title>
    <meta name="description" content="">
    <meta name="author" content="Solid Interactive">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link href="http://solid-interactive.github.io/Recipes/assets/themes/hooligan/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="http://solid-interactive.github.io/Recipes/assets/themes/hooligan/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="http://solid-interactive.github.io/Recipes/assets/themes/hooligan/css-social-buttons/css/zocial.stripped.css">
    <link href="http://solid-interactive.github.io/Recipes/assets/themes/hooligan/css/pygments.css" rel="stylesheet" type="text/css" media="all">
    <link href="http://solid-interactive.github.io/Recipes/assets/themes/hooligan/css/darkstrap.css" rel="stylesheet" type="text/css" media="all">
    <link href="http://solid-interactive.github.io/Recipes/assets/themes/hooligan/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- fav and touch icons -->
    <!-- Update these with your own images
      <link rel="shortcut icon" href="images/favicon.ico">
      <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
      <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
      <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
    -->
  </head>

  <body>
    <div id="page-wrap">
      <div class="navbar">
        <div class="navbar-inner">
          <div class="container">
            <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </a>

            <a class="brand" href="http://solid-interactive.github.io/Recipes">Solid Recipes</a>

            <div class="nav-collapse">
              <ul class="nav">
                
                
                


  
    
      
      	
      	<li><a href="http://solid-interactive.github.io/Recipes/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="http://solid-interactive.github.io/Recipes/categories.html">Categories</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="http://solid-interactive.github.io/Recipes/pages.html">Pages</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="http://solid-interactive.github.io/Recipes/tags.html">Tags</a></li>
      	
      
    
  



              </ul>
              <ul class="nav pull-right social visible-desktop">
                <li class="divider-vertical"></li>
                
                <li>
                  <a href="https://github.com/username" class="zocial github icon" target="_blank">
                    <span class="hidden-desktop">Github</span>
                  </a>
                </li>
                
                
                
                <li>
                  <a href="https://twitter.com/thinksolid" class="zocial twitter icon" target="_blank">
                    <span class="hidden-desktop">Twitter</span>
                  </a>
                </li>
                
                
                
                
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div class="container">
        <div class="content">
          
<div class="page-header">
  <h1>
    Drag and drop with jQuery UI example 
    
  </h1>
</div>

<div class="row">
  <div class="span8">
    <p><a href="http://solid-interactive.github.io/masseuse-examples/drag-and-drop">Sample code</a></p>

<p>The interesting thing about drag and drop, is that the DOM gets out of sync with Rivets.
When sorting with jquery ui, Rivets does not know about the sort. So, we sync the collection on our own. </p>

<p>Jquery Ui Drag and drop provides an <a href="http://api.jqueryui.com/sortable/#event-update">update</a> event when you have stopped sorting and the dom is done updating.
We use this callback to re-synchronize the dom and the collection.</p>

<p>When you initialize the sortable element, you can pass a callback for specific events.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">$sortable</span><span class="p">.</span><span class="nx">sortable</span><span class="p">({</span>
    <span class="nx">update</span> <span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">debounce</span><span class="p">(</span><span class="nx">_update</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">$sortable</span><span class="p">),</span> <span class="mi">50</span><span class="p">)</span>
<span class="p">});</span>
</code></pre></div>
<p>The update method iterates over the dom and resets the collection with the new order.
The collection reset needs to be silent, as we do not want rivets to re-render the dom when we reset.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">_update</span><span class="p">(</span><span class="nx">$sortable</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">fruits</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

    <span class="nx">$sortable</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;li&#39;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">fruits</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;modelid&#39;</span><span class="p">));</span>
    <span class="p">});</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">reset</span><span class="p">(</span><span class="nx">fruits</span><span class="p">,</span> <span class="p">{</span><span class="nx">silent</span> <span class="o">:</span> <span class="kc">true</span><span class="p">});</span>
<span class="p">}</span>
</code></pre></div>
<p>Important:
The html needs to have the model&#39;s id on the sortable item somewhere. The important line is the <code>data-rv-modelid</code>.
We use the models <code>cid</code> as that is unique to each model.</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;ul</span> <span class="na">id=</span><span class="s">&quot;sortable&quot;</span> <span class="na">class=</span><span class="s">&quot;ui-sortable&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">&quot;ui-state-default&quot;</span> <span class="na">data-rv-each-fruit=</span><span class="s">&quot;collection:&quot;</span> <span class="na">data-rv-modelid=</span><span class="s">&quot;fruit.cid&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>
</code></pre></div>
    <hr>
    <div class="pagination btn-group">
      
        <a class="btn prev" href="http://solid-interactive.github.io/Recipes/child-view-binder-example" title="Child view binder example">&larr; Previous</a>
      
        <a class="btn" href="http://solid-interactive.github.io/Recipes/archive.html">Archive</a>
      
        <a class="btn next" href="http://solid-interactive.github.io/Recipes/rivets-binder-example" title="Rivets Binder example">Next &rarr;</a>
      
    </div>
    <hr>
    
  </div>
  
  <div class="span4">
    <section>
      <h4>Published</h4>
      <div class="date"><span>07 July 2014</span></div>
    </section>
    
      <section>
        <h4>Category</h4>
        <span class="category">
          examples
        </span>
      </section>
         
    
      <section>
        <h4>Tags</h4>
        <ul class="tag_box">
          
          


  
     
    	<li><a href="http://solid-interactive.github.io/Recipes/tags.html#jquery ui-ref">jquery ui <span>1</span></a></li>
     
    	<li><a href="http://solid-interactive.github.io/Recipes/tags.html#drag and drop-ref">drag and drop <span>1</span></a></li>
     
    	<li><a href="http://solid-interactive.github.io/Recipes/tags.html#rivets-ref">rivets <span>5</span></a></li>
    
  



        </ul>
      </section>
             
  </div>
</div>


        </div>
      </div> <!-- /container -->

      <div class="footer-push"></div>
    </div><!--/.page-wrap -->

    <footer>
      <div class="container">
        <p>&copy; 2014 Solid Interactive
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://github.com/dhulihan/hooligan" target="_blank">The Hooligan Theme</a>
        </p>
      </div>
    </footer>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="http://solid-interactive.github.io/Recipes/assets/themes/hooligan/js/jquery.min.js"><\/script>')</script>
    <script src="http://solid-interactive.github.io/Recipes/assets/themes/hooligan/bootstrap/js/bootstrap.min.js"></script>

    


  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-123-12']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </body>
</html>

